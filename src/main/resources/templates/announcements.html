<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">公告列表</title>
    
    <!-- 引入CSS文件 -->
    <link rel="stylesheet" th:href="@{/plugins/announcement/assets/static/likcc-announcement-list.css}">
    
    <!-- 引入图标字体 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css">
</head>
<body class="likcc-announcement-shell likcc-announcement-list-root">
    <!-- 顶部横幅（Hero） -->
    <header class="likcc-announcement-hero">
        <div class="likcc-announcement-container">
            <div class="likcc-announcement-hero__title">
                <i class="ri-megaphone-line"></i>
                公告中心
            </div>
            <div class="likcc-announcement-hero__subtitle">最新通知与重要信息</div>
        </div>
    </header>



    <!-- 主要内容区域 -->
    <main class="likcc-announcement-main">
        <div class="likcc-announcement-container">


                        <!-- 公告文章列表 -->
            <div class="likcc-announcement-articles" th:if="${announcements != null and #lists.size(announcements) > 0}">
                <article class="likcc-announcement-article" th:each="announcement : ${announcements}" th:data-id="${announcement.metadata.name}">
                    <a class="likcc-announcement-article__thumb" th:href="@{'/announcements/' + ${announcement.metadata.name}}" aria-label="查看详情">
                        <img alt="封面" />
                        <span class="likcc-announcement-article__pin" th:if="${announcement.spec.enablePinning}"><i class="ri-pushpin-2-fill"></i>置顶</span>
                    </a>
                    <div class="likcc-announcement-article__body">
                        <h2 class="likcc-announcement-article__title">
                            <a th:href="@{'/announcements/' + ${announcement.metadata.name}}" th:text="${announcement.spec.title}">公告标题</a>
                        </h2>
                        <div class="likcc-announcement-article__meta">
                            <span class="likcc-announcement-article__date"><i class="ri-time-line"></i><span th:text="${#dates.format(announcement.metadata.creationTimestamp, 'yyyy-MM-dd')}">日期</span></span>
                        </div>
                        <!-- 隐藏源内容，用于前端提取摘要与封面 -->
                        <div class="likcc-announcement-article__source" th:utext="${announcement.spec.content}" style="display:none"></div>
                        <p class="likcc-announcement-article__excerpt">加载中...</p>
                        <div class="likcc-announcement-article__actions">
                            <a class="likcc-announcement-article__btn likcc-announcement-article__btn--primary" th:href="@{'/announcements/' + ${announcement.metadata.name}}">阅读更多</a>
                            <button class="likcc-announcement-article__btn" th:data-announcement-id="${announcement.metadata.name}"
                                    onclick="likccAnnouncementListShare(this.getAttribute('data-announcement-id'))">分享</button>
                        </div>
                    </div>
                </article>
            </div>

            <!-- 空状态 -->
            <div th:if="${announcements == null or #lists.size(announcements) == 0}" class="likcc-announcement-list-empty-state">
                <div class="likcc-announcement-list-empty-icon">
                    <i class="ri-megaphone-line"></i>
                </div>
                <h3 class="likcc-announcement-list-empty-title">暂无公告</h3>
                <p class="likcc-announcement-list-empty-description">
                    当前还没有发布任何公告
                </p>
                <div class="likcc-announcement-list-empty-actions">
                    <a href="/" class="likcc-announcement-list-empty-button">
                        <i class="ri-home-line"></i>
                        返回首页
                    </a>
                </div>
            </div>

            <!-- 分页导航 -->
            <div th:if="${totalPages > 1}" class="likcc-announcement-list-pagination-container">
                <nav class="likcc-announcement-list-pagination" aria-label="公告分页">
                    <!-- 上一页 -->
                    <a th:if="${currentPage > 1}" 
                       th:href="@{/announcements(page=${currentPage - 1}, size=20)}"
                       class="likcc-announcement-list-pagination-item likcc-announcement-list-pagination-prev">
                        <i class="ri-arrow-left-s-line"></i>
                        上一页
                    </a>
                    
                    <!-- 页码 -->
                    <div class="likcc-announcement-list-pagination-numbers">
                        <a th:each="pageNum : ${#numbers.sequence(1, totalPages)}"
                           th:href="@{/announcements(page=${pageNum}, size=20)}"
                           th:class="'likcc-announcement-list-pagination-item' + (${pageNum == currentPage} ? ' likcc-announcement-list-pagination-active' : '')"
                           th:text="${pageNum}">
                            1
                        </a>
                    </div>
                    
                    <!-- 下一页 -->
                    <a th:if="${currentPage < totalPages}" 
                       th:href="@{/announcements(page=${currentPage + 1}, size=20)}"
                       class="likcc-announcement-list-pagination-item likcc-announcement-list-pagination-next">
                        下一页
                        <i class="ri-arrow-right-s-line"></i>
                    </a>
                </nav>
                

            </div>
        </div>
    </main>

    <!-- 页面底部 -->
    <footer class="likcc-announcement-footer">
        <div class="likcc-announcement-container">
            <p class="likcc-announcement-footer__text">
                <i class="ri-heart-line"></i>
                公告系统由 Halo 公告插件提供支持
            </p>
        </div>
    </footer>

    <!-- 分享弹窗 -->
    <div id="likccAnnouncementListShareModal" class="likcc-announcement-list-share-modal">
        <div class="likcc-announcement-list-share-modal-content">
            <div class="likcc-announcement-list-share-modal-header">
                <h3>分享公告</h3>
                <button class="likcc-announcement-list-share-modal-close" onclick="likccAnnouncementListCloseShareModal()">
                    <i class="ri-close-line"></i>
                </button>
            </div>
            <div class="likcc-announcement-list-share-modal-body">
                <div class="likcc-announcement-list-share-options">
                    <button class="likcc-announcement-list-share-option" onclick="likccAnnouncementListShareToWeChat()">
                        <i class="ri-wechat-line"></i>
                        微信
                    </button>
                    <button class="likcc-announcement-list-share-option" onclick="likccAnnouncementListShareToWeibo()">
                        <i class="ri-weibo-line"></i>
                        微博
                    </button>
                    <button class="likcc-announcement-list-share-option" onclick="likccAnnouncementListCopyLink()">
                        <i class="ri-link"></i>
                        复制链接
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 引入JavaScript文件 -->
    <script th:src="@{/plugins/announcement/assets/static/likcc-announcement-list.js}"></script>
</body>
</html> 